<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œì•„ ìƒê¸‰ ìœµí™” ì¬ë£Œ ê³„ì‚°ê¸°</title>
    <style>
        :root {
            --bg-color: #212529;
            --card-bg: #2c3035;
            --primary: #5c7cfa;
            --text-color: #f8f9fa;
            --border-color: #495057;
            --highlight: #ffd43b;
        }
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 500px;
        }
        h1 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.5rem;
            color: var(--primary);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: #343a40;
            color: white;
            font-size: 1rem;
            box-sizing: border-box;
        }
        select:focus, input:focus {
            outline: none;
            border-color: var(--primary);
        }
        .btn {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: 0.2s;
        }
        .btn:hover {
            filter: brightness(1.1);
        }
        .result-box {
            margin-top: 25px;
            padding: 20px;
            background-color: #343a40;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            display: none;
        }
        .result-title {
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 10px;
        }
        .result-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }
        .highlight {
            color: var(--highlight);
            font-weight: bold;
        }
        .sub-text {
            font-size: 0.8rem;
            color: #adb5bd;
            text-align: center;
            margin-top: 15px;
            line-height: 1.4;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ› ï¸ ìƒê¸‰ ì•„ë¹„ë„ìŠ¤ ì œì‘ ê³„ì‚°ê¸°</h1>

    <div class="form-group">
        <label>ìƒí™œ ì¢…ë¥˜ ì„ íƒ</label>
        <select id="lifeType" onchange="updateLabels()">
            <option value="foraging">ğŸŒ± ì±„ì§‘ (ë“¤ê½ƒ)</option>
            <option value="logging">ğŸª“ ë²Œëª© (ëª©ì¬)</option>
            <option value="hunting">ğŸ¥© ìˆ˜ë µ (ìƒê³ ê¸°)</option>
        </select>
    </div>

    <div class="form-group">
        <label id="label-t4" class="highlight">ì•„ë¹„ë„ìŠ¤ ë“¤ê½ƒ (4í‹°ì–´)</label>
        <input type="number" id="input-t4" placeholder="ë³´ìœ  ìˆ˜ëŸ‰ ì…ë ¥" min="0">
    </div>

    <div class="form-group">
        <label id="label-rare" style="color:#4dabf7">ìˆ˜ì¤ì€ ë“¤ê½ƒ (3í‹°ì–´ í¬ê·€)</label>
        <input type="number" id="input-rare" placeholder="ë³´ìœ  ìˆ˜ëŸ‰ ì…ë ¥" min="0">
    </div>

    <div class="form-group">
        <label id="label-normal">ë“¤ê½ƒ (3í‹°ì–´ ì¼ë°˜)</label>
        <input type="number" id="input-normal" placeholder="ë³´ìœ  ìˆ˜ëŸ‰ ì…ë ¥" min="0">
    </div>

    <button class="btn" onclick="calculate()">ê³„ì‚°í•˜ê¸°</button>

    <div class="result-box" id="resultArea">
        <div class="result-title">
            ìµœëŒ€ <span class="highlight" id="maxCrafts">0</span>íšŒ ì œì‘ ê°€ëŠ¥
        </div>
        
        <div style="margin-bottom:15px;">
            <label style="color:#adb5bd; border-bottom:1px solid #495057; padding-bottom:5px;">ğŸ“‹ 1ë‹¨ê³„: ì¸ë²¤í† ë¦¬ì— ë‚¨ê¸¸ ì¬ë£Œ</label>
            <div class="result-row">
                <span id="res-keep-normal-name">ì¼ë°˜ ì¬ë£Œ</span>
                <span id="res-keep-normal-val">0ê°œ</span>
            </div>
            <div class="result-row">
                <span id="res-keep-rare-name">í¬ê·€ ì¬ë£Œ</span>
                <span id="res-keep-rare-val">0ê°œ</span>
            </div>
        </div>

        <div style="margin-bottom:15px;">
            <label style="color:#adb5bd; border-bottom:1px solid #495057; padding-bottom:5px;">â™»ï¸ 2ë‹¨ê³„: ê°€ë£¨ë¡œ êµí™˜í•  ì¬ë£Œ (ì •í™•í•œ ë‹¨ìœ„)</label>
            <div class="result-row">
                <span id="res-conv-normal-name">ì¼ë°˜ ì¬ë£Œ êµí™˜</span>
                <span class="highlight" id="res-conv-normal-val">0ê°œ</span>
            </div>
            <div class="result-row">
                <span id="res-conv-rare-name">í¬ê·€ ì¬ë£Œ êµí™˜</span>
                <span class="highlight" id="res-conv-rare-val">0ê°œ</span>
            </div>
        </div>

        <div>
            <label style="color:#adb5bd; border-bottom:1px solid #495057; padding-bottom:5px;">ğŸ›’ 3ë‹¨ê³„: ê°€ë£¨ë¡œ êµ¬ë§¤</label>
            <div class="result-row">
                <span>êµ¬ë§¤í•  4í‹°ì–´ ì¬ë£Œ</span>
                <span class="highlight" id="res-buy-t4">0ê°œ</span>
            </div>
        </div>
    </div>
    
    <div class="sub-text">
        * ì¸ê²Œì„ êµí™˜ ë¹„ìœ¨ ì™„ë²½ ì ìš© (ì¼ë°˜ 100ë‹¨ìœ„, í¬ê·€ 50ë‹¨ìœ„ êµí™˜)<br>
        * ê°€ì¹˜ê°€ ë‚®ì€ 'ì¼ë°˜ ì¬ë£Œ'ë¶€í„° ìš°ì„ ì ìœ¼ë¡œ ê°€ë£¨ë¡œ êµí™˜í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
    </div>
</div>

<script>
    const labels = {
        foraging: { t4: "ì•„ë¹„ë„ìŠ¤ ë“¤ê½ƒ", rare: "ìˆ˜ì¤ì€ ë“¤ê½ƒ", normal: "ë“¤ê½ƒ" },
        logging: { t4: "ì•„ë¹„ë„ìŠ¤ ëª©ì¬", rare: "ë¶€ë“œëŸ¬ìš´ ëª©ì¬", normal: "ëª©ì¬" },
        hunting: { t4: "ì•„ë¹„ë„ìŠ¤ ë‘íˆ¼í•œ ìƒê³ ê¸°", rare: "ë‹¤ë“¬ì€ ìƒê³ ê¸°", normal: "ë‘íˆ¼í•œ ìƒê³ ê¸°" }
    };

    function updateLabels() {
        const type = document.getElementById('lifeType').value;
        document.getElementById('label-t4').innerText = labels[type].t4 + " (4í‹°ì–´)";
        document.getElementById('label-rare').innerText = labels[type].rare + " (3í‹°ì–´ í¬ê·€)";
        document.getElementById('label-normal').innerText = labels[type].normal + " (3í‹°ì–´ ì¼ë°˜)";
    }

    function calculate() {
        const type = document.getElementById('lifeType').value;
        
        const hasT4 = Number(document.getElementById('input-t4').value) || 0;
        const hasRare = Number(document.getElementById('input-rare').value) || 0;
        const hasNormal = Number(document.getElementById('input-normal').value) || 0;

        const REQ = { t4: 43, rare: 59, normal: 112 };

        // 3í‹°ì–´ ì¬ë£Œ í•œê³„ì¹˜ë¡œ ìµœëŒ€ ê°€ëŠ¥í•œ ì œì‘ íšŸìˆ˜ ìƒí•œì„  êµ¬í•˜ê¸°
        const maxLimit = Math.min(
            Math.floor(hasNormal / REQ.normal), 
            Math.floor(hasRare / REQ.rare)
        );

        let bestCrafts = 0;
        let finalConvertNormal = 0;
        let finalConvertRare = 0;
        let finalBuyT4 = 0;
        let keepNormal = 0;
        let keepRare = 0;

        // ìƒí•œì„ ë¶€í„° 0íšŒê¹Œì§€ ë‚´ë ¤ê°€ë©´ì„œ ê°€ì¥ ë¨¼ì € ì¡°ê±´ì´ ë§ëŠ” íšŸìˆ˜ ì°¾ê¸°
        for (let i = maxLimit; i >= 0; i--) {
            const neededNormal = i * REQ.normal;
            const neededRare = i * REQ.rare;
            const neededT4 = i * REQ.t4;

            const leftoverNormal = hasNormal - neededNormal;
            const leftoverRare = hasRare - neededRare;

            // ê²Œì„ ë‚´ êµí™˜ ë¬¶ìŒ (ì¼ë°˜ 100ê°œ, í¬ê·€ 50ê°œ)
            const maxNormalBatches = Math.floor(leftoverNormal / 100);
            const maxRareBatches = Math.floor(leftoverRare / 50);

            // ë¶€ì¡±í•œ 4í‹°ì–´ ì¬ë£Œ ìˆ˜ëŸ‰ (10ê°œ ë‹¨ìœ„ë¡œ êµ¬ë§¤í•´ì•¼ í•¨)
            const deficitT4 = Math.max(0, neededT4 - hasT4);
            const buyBatchesT4 = Math.ceil(deficitT4 / 10);
            
            // 1ë²ˆ êµ¬ë§¤(10ê°œ)ë‹¹ 100ê°€ë£¨ í•„ìš”
            const powderNeeded = buyBatchesT4 * 100; 
            
            // 1ë²ˆ êµí™˜(ë¬¶ìŒ)ë‹¹ 80ê°€ë£¨ íšë“
            const powderBatchesNeeded = Math.ceil(powderNeeded / 80); 

            // ë‚¨ëŠ” ì¬ë£Œë¥¼ ê°€ë£¨ë¡œ ë°”ê¿¨ì„ ë•Œ êµ¬ë§¤ê°€ ê°€ëŠ¥í•œì§€ í™•ì¸
            if (maxNormalBatches + maxRareBatches >= powderBatchesNeeded) {
                bestCrafts = i;
                keepNormal = neededNormal;
                keepRare = neededRare;

                // ì¼ë°˜ ì¬ë£Œë¥¼ ìš°ì„ ì ìœ¼ë¡œ êµí™˜í•˜ì—¬ í¬ê·€ ì¬ë£Œë¥¼ ì•„ë‚Œ
                let useNormalBatches = Math.min(powderBatchesNeeded, maxNormalBatches);
                let useRareBatches = powderBatchesNeeded - useNormalBatches;

                finalConvertNormal = useNormalBatches * 100;
                finalConvertRare = useRareBatches * 50;
                finalBuyT4 = buyBatchesT4 * 10;
                break;
            }
        }

        // UI ì¶œë ¥
        document.getElementById('resultArea').style.display = 'block';
        document.getElementById('maxCrafts').innerText = bestCrafts;

        document.getElementById('res-keep-normal-name').innerText = labels[type].normal + " ìœ ì§€";
        document.getElementById('res-keep-rare-name').innerText = labels[type].rare + " ìœ ì§€";
        document.getElementById('res-conv-normal-name').innerText = labels[type].normal + " êµí™˜";
        document.getElementById('res-conv-rare-name').innerText = labels[type].rare + " êµí™˜";

        document.getElementById('res-keep-normal-val').innerText = keepNormal.toLocaleString() + "ê°œ";
        document.getElementById('res-keep-rare-val').innerText = keepRare.toLocaleString() + "ê°œ";
        document.getElementById('res-conv-normal-val').innerText = finalConvertNormal.toLocaleString() + "ê°œ";
        document.getElementById('res-conv-rare-val').innerText = finalConvertRare.toLocaleString() + "ê°œ";
        
        document.getElementById('res-buy-t4').innerText = labels[type].t4 + " " + finalBuyT4.toLocaleString() + "ê°œ êµ¬ë§¤";
    }

    updateLabels();
</script>

</body>
</html>
